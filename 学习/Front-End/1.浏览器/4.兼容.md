# 1. 浏览器技术

## 1.1 Ajax

    是一种用于在后台与服务器进行数据交换的技术，
    使用 JavaScript 和 XMLHttpRequest 对象，
    发送异步请求并接收服务器返回的数据，而无需刷新整个页面。

```javascript
      var xhr = new XMLHttpRequest();// 创建XmlHttpRequest对象xmh
      xhr.open('GET', 'http://example.com/api', true);// 设置请求的方法、URL 和是否使用异步模式（通常为 true）：

      xhr.onreadystatechange = function() {// 设置请求完成后的回调函数：
      if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
      // 处理服务器返回的响应数据
      }
      };

      xhr.setRequestHeader('Content-Type', 'application/json'); // 设置请求头
      xhr.send(); // 发送请求，如果有请求体可以在 send() 方法中传入

      var responseData = JSON.parse(xhr.responseText); // 将服务器返回的 JSON 数据解析为 JavaScript 对象
      // 处理服务器返回的响应数据

```

## 1.2 Json

    是一种轻量级的数据交换格式，它是一种易于人阅读和编写的文本格式，并且易于机器解析和生成。
      在发送和接收JSON数据时，需要确保正确设置请求和响应的Content-Type为"application/json"。
      JS提供了JSON.parse() 解析成对象  JSON.stringify() - 对象转化为字符串
      使用场景：
            1. 定义接口
            2. 序列化
            3. 生成token
            4. 配置文件package.json

## 1.4 Token

- 概念
  验证身份的令牌，通过加密后的字符串
- 存储
  1. 存localstorage:
     后期每次请求接口都要把他当作字段传给后台，
     容易被XSS攻击
  2. 存在cooie自动发送， 但不能跨域，
     容易被CSRF攻击
- 登陆流程
  1. 客户端用账号密码请求登陆
  2. 服务端收到请求后， 去验证账号密码
  3. 验证成功后， 服务端签发token，并发送给客户端
  4. 客户端收到token后保存起来
  5. 客户端每次向服务端发送请求资源时， 都要携带token
  6. 服务端收到请求，接着去验证客户端的token， 验证成功后返回客户端请求的数据
- JWT
  概念： JSON Web Token
  作用： 通过JSON形式作为web应用中的令牌
  在各方之间 安全的 把信息作为JSON对象传输、授权
  认证流程
  1. 前端把账号密码发送给后端接口
  2. 后端核对账号密码后， 把用户id等其他信息作为JWT负载， 把他和头部分别进行base64编码拼接后签名， 形成JWT
  3. 前端每日请求时，都会把JWT放在HTTP请求头的【Authorization】字段内
  4. 后端检查是否存在， 如果存在就检验JWT的有效性
  5. 验证通过后， 后端使用JWT中包含得到用户信息进行其他操作， 并发相应的结果

# 2. 浏览器兼容
造成浏览器兼容性问题的根本原因就是各浏览器使用了不同的内核，并且它们处理同一件事情的时候思路不同。
## 2.0 浏览器兼容工具

- 1. CSS hack是通过在CSS样式中加入一些特殊的符号也就是浏览器前缀，让不同的浏览器识别不同的符号以达到应用不同的CSS样式的目的。
- 2. polyfill 是一段代码(或者插件)，提供了那些开发者们希望浏览器原生提供支持的功能。
- 3. PostCSS是一个利用JS插件来对CSS进行转换的工具
- 4. Modernizr.js十分的强大，既能给老版本浏览器打补丁，又能保证新浏览器渐进增强的用户体验。

## 2.1 CSS兼容
1、不同浏览器的标签默认的内外边距不同
解决方案：*{margin: 0; padding: 0;}
其实清除浏览器自带的默认样式，每个前端开发者所用的方法大同小异，这里给出我选用的清除默认样式的重置样式代码：
```css
/**
 * 该文件用于清除浏览器样式
 */
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed,
figure, figcaption, footer, header, hgroup,
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
    padding:0;
    margin:0;
    border:0;
    outline: 0;
    font-family: "Helvetica Neue For Number", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif;
    word-wrap:break-word;
}
html, body {
    width: 100%;
    height: 100%;
}
a {
    text-decoration: none;
    -webkit-tap-highlight-color:rgba(255,255,255,0);
}
ul, ol {
    list-style-type: none;
}
textarea {
    resize: none;
}
/*去除input button默认样式*/
input, button, textarea {
    -webkit-appearance: none;
    -webkit-tap-highlight-color: rgba(255, 225, 225, 0);
    padding: 0;
    border: 0;
    outline: 0;
}
// 修改placeholder属性默认文字颜色
input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {
    /* WebKit browsers */
    color: #999;
}
input:-moz-placeholder, textarea:-moz-placeholder {
    /* Mozilla Firefox 4 to 18 */
    color: #999;
}
input::-moz-placeholder, textarea::-moz-placeholder {
    /* Mozilla Firefox 19+ */
    color: #999;
}
input:-ms-input-placeholder, textarea:-ms-input-placeholder {
    /* Internet Explorer 10+ */
    color: #999;
}
```
除了自己定义清除默认样式的代码，也可选择引用别人写好的成熟插件Normalize.css来清除默认样式；

## 2.2 JS兼容问题
1、事件对象的兼容
e = ev || window.event
2、滚动事件的兼容
scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
3、阻止冒泡的兼容
```js
  if (e.stopPropagation) {
      e.stopPropagation();
  } else {
      e.cancelBubble=true;
  }
```
4、阻止默认行为的兼容
```js
  if (e.preventDefault) {
      e.preventDefault();
  } else {
      e.returnValue = false;
  }
```
5、添加事件监听器的兼容
```js
  if (target.addEventListener) {
      target.addEventListener("click", fun, false);
  } else {
      target.attachEvent("onclick", fun);
  }
```
6、ajax创建对象的兼容
```js
  var xhr = null；
  if (window.XMLHttpRequest) {
      xhr = new XMLHttpRequest();
  } else {
      xhr = new ActiveXObject("Microsoft XMLHTTP");
  } 
```
7、鼠标按键编码的兼容
```js
  function mouse (ev) {
      var e = ev || window.event; 
      if (evt) {
          return e.button;
      } else if (window.event) {
          switch (e.button) {
              case 1: return 0;
              case 4: return 1;
              case 2: return 2;
          }
      }  
  }
```
8、在IE中，event对象有x，y属性，Firefox中与event.x等效的是event.pageX，而event.pageX在IE中又没有
x = event.x ? event.x : event.pageX;
9、在IE下，event对象有srcElement属性，但是没有target属性；Firefox下，event对象有target属性，但是没有srcElement属性
```js
  var source = ev.target || ev.srcElement;
  var target = ev.relatedTarget || ev.toElement;
```
10、在Firefox下需要用CSS禁止选取网页内容，在IE用JS禁止
```js
-moz-user-select: none; // Firefox 
obj.onselectstart = function() {return false;} // IE
```
11、innerText在IE中能正常工作，但在FireFox中却不行
```js
if (navigator.appName.indexOf("Explorer") > -1) {
    document.getElementById('element').innerText = "IE";
} else {
    document.getElementById('element').textContent = "Firefox";
}
```
12、在Firefox下，可以使用const关键字或var关键字来定义常量；在IE下，只能使用var关键字来定义常量
解决方案：统一使用var关键字来定义常量


## 2.3 移动端兼容问题
1、禁止iOS识别长串数字为电话
解决方案：<meta content="telephone=no" name="format-detection" />
2、禁止iOS弹出各种操作窗口
解决方案：-webkit-touch-callout:none
3、禁止Android手机识别邮箱
解决方案：<meta content="email=no" name="format-detection" />
4、禁止iOS和Android用户选中文字
解决方案：-webkit-user-select:none
5、iOS下取消input在输入的时候英文首字母的默认大写
解决方案：<input autocapitalize="off" autocorrect="off" />
6、Android下取消输入语音按钮
解决方案：input::-webkit-input-speech-button {display: none}
7、在移动端修改难看的点击的高亮效果，iOS和安卓下都有效
解决方案：* {-webkit-tap-highlight-color:rgba(0,0,0,0);}
8、iOS下input为type=button属性disabled设置true，会出现样式文字和背景异常问题
解决方案：使用opacity=1;
9、input为fixed定位，在iOS下input固定定位在顶部或者底部，在页面滚动一些距离后，点击input(弹出键盘)，input位置会出现在中间位置
解决方案：内容列表框也是fixed定位，这样不会出现fixed错位的问题
10、移动端字体小于12px使用四周边框或者背景色块，部分安卓文字偏上bug问题
解决方案：可以使用整体放大1倍(width、height、font-size等等)，再使用transform缩放
11、在移动端图片上传图片兼容低端机的问题
解决方案：input 加入属性accept="image/*" multiple
12、在Android上placeholder文字设置行高会偏上
解决方案：input有placeholder情况下不要设置行高
13、overflow: scroll或auto；在iOS上滑动卡顿的问题
解决方案:加入-webkit-overflow-scrolling: touch;
14、iOS中日期如：2022-02-22 00:00:00格式的时间转时间戳不成功
解决方案：需要将时间中的'00:00:00去除之后才能转为时间戳'
